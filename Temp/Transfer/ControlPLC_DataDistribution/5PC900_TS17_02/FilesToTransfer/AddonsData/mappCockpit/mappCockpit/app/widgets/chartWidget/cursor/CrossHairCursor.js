var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
define(["require", "exports", "./CursorDefinitionBase"], function (require, exports, CursorDefinitionBase_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var CrossHairCursor = /** @class */ (function (_super) {
        __extends(CrossHairCursor, _super);
        function CrossHairCursor(cursorHandlerId, cursorIndex) {
            var _this = _super.call(this, cursorHandlerId, cursorIndex) || this;
            _this.cursorCenterOffset = 4;
            _this.crosshairId = cursorHandlerId + CrossHairCursor.crossHairCursorId + "_" + cursorIndex + "_crossHair";
            return _this;
        }
        CrossHairCursor.prototype.drawCursor = function (leadCursorPosition, cursorPositions) {
            if (leadCursorPosition != undefined && cursorPositions[0] != undefined) {
                this.cursorPositions = cursorPositions;
                this.leadCursorPosition = leadCursorPosition;
                for (var i = 0; i < cursorPositions.length; i++) {
                    this.drawCrosshair(cursorPositions[i].position, i, cursorPositions[i].additionalInformation["hovered"], cursorPositions[i].additionalInformation["highlight"], cursorPositions[i].additionalInformation["selected"]);
                }
            }
        };
        CrossHairCursor.prototype.removeCursors = function () {
            var cursorElements = document.getElementsByClassName(this.crosshairId);
            while (cursorElements[0]) {
                cursorElements[0].remove();
            }
        };
        CrossHairCursor.prototype.drawCrosshair = function (position, index, hovered, highlight, selected) {
            var svgHtml;
            var currentColor = this.cursorColor;
            if (selected) {
                currentColor = this.selectedColor;
            }
            if (hovered) {
                currentColor = this.hoverColor;
            }
            if (!highlight) {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y + 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            else {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y - 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y + 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x - 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            var cursorHandler = document.getElementById(this.cursorHandlerContainerId);
            if (cursorHandler != undefined) {
                cursorHandler.innerHTML += svgHtml;
            }
        };
        CrossHairCursor.prototype.getClosestCursorPositionToPoint = function (point) {
            var distance = undefined;
            var currentClosestCursorPosition;
            if (this.cursorPositions != undefined) {
                for (var i = 0; i < this.cursorPositions.length; i++) {
                    if (distance == undefined || distance > this.calculateDistance(this.cursorPositions[i].position, point)) {
                        distance = this.calculateDistance(this.cursorPositions[i].position, point);
                        currentClosestCursorPosition = this.cursorPositions[i];
                        currentClosestCursorPosition.additionalInformation["distance"] = distance - this.cursorCenterOffset;
                    }
                }
            }
            return currentClosestCursorPosition;
        };
        /**
         * calculate distance between two points
         *
         * @private
         * @param {IPoint} point1
         * @param {IPoint} point2
         * @returns {number}
         * @memberof CrossHairCursor
         */
        CrossHairCursor.prototype.calculateDistance = function (point1, point2) {
            return (Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow((point2.y - point1.y), 2)));
        };
        CrossHairCursor.crossHairCursorId = "crossHairCursor";
        return CrossHairCursor;
    }(CursorDefinitionBase_1.CursorDefinitionBase));
    exports.CrossHairCursor = CrossHairCursor;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3Jvc3NIYWlyQ3Vyc29yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2FwcC93aWRnZXRzL2NoYXJ0V2lkZ2V0L2N1cnNvci9Dcm9zc0hhaXJDdXJzb3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztJQUdBO1FBQXFDLG1DQUFvQjtRQU9yRCx5QkFBWSxlQUF1QixFQUFFLFdBQW1CO1lBQXhELFlBQ0ksa0JBQU0sZUFBZSxFQUFFLFdBQVcsQ0FBQyxTQUV0QztZQVBELHdCQUFrQixHQUFXLENBQUMsQ0FBQztZQU0zQixLQUFJLENBQUMsV0FBVyxHQUFHLGVBQWUsR0FBRyxlQUFlLENBQUMsaUJBQWlCLEdBQUcsR0FBRyxHQUFHLFdBQVcsR0FBRyxZQUFZLENBQUM7O1FBQzlHLENBQUM7UUFFRCxvQ0FBVSxHQUFWLFVBQVcsa0JBQWtDLEVBQUUsZUFBaUM7WUFDNUUsSUFBSSxrQkFBa0IsSUFBSSxTQUFTLElBQUksZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLFNBQVMsRUFBRTtnQkFDcEUsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7Z0JBQ3ZDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztnQkFDN0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGVBQWUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7b0JBQzdDLElBQUksQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxXQUFXLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztpQkFDeE47YUFDSjtRQUNMLENBQUM7UUFFRCx1Q0FBYSxHQUFiO1lBQ0ksSUFBSSxjQUFjLEdBQUcsUUFBUSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUUsQ0FBQztZQUN4RSxPQUFPLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDdEIsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO2FBQzlCO1FBQ0wsQ0FBQztRQUVPLHVDQUFhLEdBQXJCLFVBQXNCLFFBQWdCLEVBQUUsS0FBYSxFQUFFLE9BQWdCLEVBQUUsU0FBa0IsRUFBRSxRQUFpQjtZQUMxRyxJQUFJLE9BQU8sQ0FBQztZQUNaLElBQUksWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7WUFDcEMsSUFBSSxRQUFRLEVBQUU7Z0JBQ1YsWUFBWSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUM7YUFDckM7WUFDRCxJQUFHLE9BQU8sRUFBQztnQkFDUCxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQzthQUNsQztZQUVELElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQ1osT0FBTyxHQUFHLDhDQUEyQyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsNkRBQ2hFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDekksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRyxpREFFN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLDRDQUV4SixDQUFDO2FBQ1g7aUJBQ0k7Z0JBQ0QsT0FBTyxHQUFHLDhDQUEyQyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsNkRBQ2hFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDekksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRyxpREFFN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLDRDQUV4SixDQUFDO2FBQ1g7WUFDRCxJQUFJLGFBQWEsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1lBQzNFLElBQUcsYUFBYSxJQUFJLFNBQVMsRUFBQztnQkFDMUIsYUFBYyxDQUFDLFNBQVMsSUFBSSxPQUFPLENBQUM7YUFDdkM7UUFDTCxDQUFDO1FBRU0seURBQStCLEdBQXRDLFVBQXVDLEtBQWE7WUFDaEQsSUFBSSxRQUFRLEdBQXVCLFNBQVMsQ0FBQztZQUM3QyxJQUFJLDRCQUE0QixDQUFDO1lBRWpDLElBQUcsSUFBSSxDQUFDLGVBQWUsSUFBSSxTQUFTLEVBQUM7Z0JBQ2pDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDbEQsSUFBSSxRQUFRLElBQUksU0FBUyxJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLEVBQUU7d0JBQ3JHLFFBQVEsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7d0JBQzNFLDRCQUE0QixHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQ3ZELDRCQUE0QixDQUFDLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxHQUFHLFFBQVEsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUM7cUJBQ3ZHO2lCQUNKO2FBQ0o7WUFDRCxPQUFPLDRCQUE0QixDQUFDO1FBQ3hDLENBQUM7UUFHRDs7Ozs7Ozs7V0FRRztRQUNLLDJDQUFpQixHQUF6QixVQUEwQixNQUFjLEVBQUUsTUFBYztZQUNwRCxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlGLENBQUM7UUFoR00saUNBQWlCLEdBQUcsaUJBQWlCLENBQUM7UUFpR2pELHNCQUFDO0tBQUEsQUF0R0QsQ0FBcUMsMkNBQW9CLEdBc0d4RDtJQXRHWSwwQ0FBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElQb2ludCB9IGZyb20gXCIuLi8uLi8uLi9tb2RlbHMvY29tbW9uL2ludGVyZmFjZXMvcG9pbnRJbnRlcmZhY2VcIjtcclxuaW1wb3J0IHsgQ3Vyc29yUG9zaXRpb24gfSBmcm9tIFwiLi9DdXJzb3JQb3NpdGlvbkluZm9cIjtcclxuaW1wb3J0IHsgQ3Vyc29yRGVmaW5pdGlvbkJhc2UgfSBmcm9tIFwiLi9DdXJzb3JEZWZpbml0aW9uQmFzZVwiO1xyXG5leHBvcnQgY2xhc3MgQ3Jvc3NIYWlyQ3Vyc29yIGV4dGVuZHMgQ3Vyc29yRGVmaW5pdGlvbkJhc2Uge1xyXG4gICAgY3Jvc3NoYWlySWQ7XHJcblxyXG4gICAgY3Vyc29yQ2VudGVyT2Zmc2V0OiBudW1iZXIgPSA0O1xyXG5cclxuICAgIHN0YXRpYyBjcm9zc0hhaXJDdXJzb3JJZCA9IFwiY3Jvc3NIYWlyQ3Vyc29yXCI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY3Vyc29ySGFuZGxlcklkOiBzdHJpbmcsIGN1cnNvckluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBzdXBlcihjdXJzb3JIYW5kbGVySWQsIGN1cnNvckluZGV4KTtcclxuICAgICAgICB0aGlzLmNyb3NzaGFpcklkID0gY3Vyc29ySGFuZGxlcklkICsgQ3Jvc3NIYWlyQ3Vyc29yLmNyb3NzSGFpckN1cnNvcklkICsgXCJfXCIgKyBjdXJzb3JJbmRleCArIFwiX2Nyb3NzSGFpclwiO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYXdDdXJzb3IobGVhZEN1cnNvclBvc2l0aW9uOiBDdXJzb3JQb3NpdGlvbiwgY3Vyc29yUG9zaXRpb25zOiBDdXJzb3JQb3NpdGlvbltdKSB7XHJcbiAgICAgICAgaWYgKGxlYWRDdXJzb3JQb3NpdGlvbiAhPSB1bmRlZmluZWQgJiYgY3Vyc29yUG9zaXRpb25zWzBdICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnNvclBvc2l0aW9ucyA9IGN1cnNvclBvc2l0aW9ucztcclxuICAgICAgICAgICAgdGhpcy5sZWFkQ3Vyc29yUG9zaXRpb24gPSBsZWFkQ3Vyc29yUG9zaXRpb247XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3Vyc29yUG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdDcm9zc2hhaXIoY3Vyc29yUG9zaXRpb25zW2ldLnBvc2l0aW9uLCBpLCBjdXJzb3JQb3NpdGlvbnNbaV0uYWRkaXRpb25hbEluZm9ybWF0aW9uW1wiaG92ZXJlZFwiXSAsY3Vyc29yUG9zaXRpb25zW2ldLmFkZGl0aW9uYWxJbmZvcm1hdGlvbltcImhpZ2hsaWdodFwiXSwgY3Vyc29yUG9zaXRpb25zW2ldLmFkZGl0aW9uYWxJbmZvcm1hdGlvbltcInNlbGVjdGVkXCJdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVDdXJzb3JzKCkge1xyXG4gICAgICAgIGxldCBjdXJzb3JFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5jcm9zc2hhaXJJZCkhO1xyXG4gICAgICAgIHdoaWxlIChjdXJzb3JFbGVtZW50c1swXSkge1xyXG4gICAgICAgICAgICBjdXJzb3JFbGVtZW50c1swXS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgZHJhd0Nyb3NzaGFpcihwb3NpdGlvbjogSVBvaW50LCBpbmRleDogbnVtYmVyLCBob3ZlcmVkOiBib29sZWFuLCBoaWdobGlnaHQ6IGJvb2xlYW4sIHNlbGVjdGVkOiBib29sZWFuKSB7XHJcbiAgICAgICAgbGV0IHN2Z0h0bWw7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRDb2xvciA9IHRoaXMuY3Vyc29yQ29sb3I7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRDb2xvciA9IHRoaXMuc2VsZWN0ZWRDb2xvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaG92ZXJlZCl7XHJcbiAgICAgICAgICAgIGN1cnJlbnRDb2xvciA9IHRoaXMuaG92ZXJDb2xvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghaGlnaGxpZ2h0KSB7XHJcbiAgICAgICAgICAgIHN2Z0h0bWwgPSBgPHN2ZyBzdHlsZT0gXCJwb3NpdGlvbjogYWJzb2x1dGVcIiBjbGFzcyA9XCJgICsgdGhpcy5jcm9zc2hhaXJJZCArIGBcIiBoZWlnaHQ9XCIxMDAlXCIgd2lkdGg9XCIxMDAlXCI+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gMTQpICsgYFwiIHkxPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5Mj1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggKyAxNCkgKyBgXCIgeTE9XCJgICsgcG9zaXRpb24ueSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkyPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSAxNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgKyAxNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcblxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc3ZnSHRtbCA9IGA8c3ZnIHN0eWxlPSBcInBvc2l0aW9uOiBhYnNvbHV0ZVwiIGNsYXNzID1cImAgKyB0aGlzLmNyb3NzaGFpcklkICsgYFwiIGhlaWdodD1cIjEwMCVcIiB3aWR0aD1cIjEwMCVcIj5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSAxNCkgKyBgXCIgeTE9XCJgICsgcG9zaXRpb24ueSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkyPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCArIDE0KSArIGBcIiB5MT1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTI9XCJgICsgcG9zaXRpb24ueSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDE0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSArIDE0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcblxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDYpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNikgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA2KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSAtIDYpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA2KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSArIDYpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNikgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA2KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNikgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA2KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCAtIDYpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNikgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCArIDYpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNikgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA2KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDYpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuXHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjdXJzb3JIYW5kbGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5jdXJzb3JIYW5kbGVyQ29udGFpbmVySWQpO1xyXG4gICAgICAgIGlmKGN1cnNvckhhbmRsZXIgIT0gdW5kZWZpbmVkKXtcclxuICAgICAgICAgICAgY3Vyc29ySGFuZGxlciEuaW5uZXJIVE1MICs9IHN2Z0h0bWw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRDbG9zZXN0Q3Vyc29yUG9zaXRpb25Ub1BvaW50KHBvaW50OiBJUG9pbnQpOiBDdXJzb3JQb3NpdGlvbiB7XHJcbiAgICAgICAgbGV0IGRpc3RhbmNlOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRDbG9zZXN0Q3Vyc29yUG9zaXRpb247XHJcblxyXG4gICAgICAgIGlmKHRoaXMuY3Vyc29yUG9zaXRpb25zICE9IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXJzb3JQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA9PSB1bmRlZmluZWQgfHwgZGlzdGFuY2UgPiB0aGlzLmNhbGN1bGF0ZURpc3RhbmNlKHRoaXMuY3Vyc29yUG9zaXRpb25zW2ldLnBvc2l0aW9uLCBwb2ludCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IHRoaXMuY2FsY3VsYXRlRGlzdGFuY2UodGhpcy5jdXJzb3JQb3NpdGlvbnNbaV0ucG9zaXRpb24sIHBvaW50KTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2xvc2VzdEN1cnNvclBvc2l0aW9uID0gdGhpcy5jdXJzb3JQb3NpdGlvbnNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENsb3Nlc3RDdXJzb3JQb3NpdGlvbi5hZGRpdGlvbmFsSW5mb3JtYXRpb25bXCJkaXN0YW5jZVwiXSA9IGRpc3RhbmNlIC0gdGhpcy5jdXJzb3JDZW50ZXJPZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRDbG9zZXN0Q3Vyc29yUG9zaXRpb247XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogY2FsY3VsYXRlIGRpc3RhbmNlIGJldHdlZW4gdHdvIHBvaW50c1xyXG4gICAgICpcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge0lQb2ludH0gcG9pbnQxXHJcbiAgICAgKiBAcGFyYW0ge0lQb2ludH0gcG9pbnQyXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAgICogQG1lbWJlcm9mIENyb3NzSGFpckN1cnNvclxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNhbGN1bGF0ZURpc3RhbmNlKHBvaW50MTogSVBvaW50LCBwb2ludDI6IElQb2ludCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIChNYXRoLnNxcnQoTWF0aC5wb3cocG9pbnQyLnggLSBwb2ludDEueCwgMikgKyBNYXRoLnBvdygocG9pbnQyLnkgLSBwb2ludDEueSksIDIpKSk7XHJcbiAgICB9XHJcbn1cclxuIl19